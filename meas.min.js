var isOpera=!!window.opr&&!!opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),isFirefox="undefined"!=typeof InstallTrigger,isSafari=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||safari.pushNotification).toString(),isIE=!!document.documentMode,isEdge=!isIE&&!!window.StyleMedia,isChrome=!!window.chrome&&!!window.chrome.webstore,isBlink=(isChrome||isOpera)&&!!window.CSS,BrowserFlags={isOpera:isOpera,isFirefox:isFirefox,isSafari:isSafari,isIE:isIE,isEdge:isEdge,isChrome:isChrome,isBlink:isBlink};Object.freeze(BrowserFlags);var isWin=-1!=navigator.appVersion.indexOf("Win"),isMac=-1!=navigator.appVersion.indexOf("Mac"),isLinux=-1!=navigator.appVersion.indexOf("Linux"),isUnix=-1!=navigator.appVersion.indexOf("X11"),OsFlags={isWin:isWin,isMac:isMac,isUnix:isUnix,isLinux:isLinux};Object.freeze(OsFlags);var meas,MEAS_TYPE="measure",MARK_TYPE="mark";function Tracker(perPtr,name){this._perfPtr=perPtr,this.startName=name+"_start",this.endName=name+"_end",this.measName=name+"_meas",this.hasMeasured=!1,this._perfPtr.mark(this.startName)}function ClearHelper(perfPtr){this.perfPtr=perfPtr}function LsHelper(perfPtr){this.perfPtr=perfPtr}function FindHelper(perfPtr){this.perfPtr=perfPtr}function PerfHelper(perfPtr){this.perfPtr=perfPtr,this.clearHelper=new ClearHelper(this.perfPtr),this.lsHelper=new LsHelper(this.perfPtr),this.findHelper=new FindHelper(this.perfPtr)}function TrackerManager(){this.trackers={},this.perfHelper=new PerfHelper(this.perfPtr),this.setPerfPtr(window.performance),this.enabled=!0}Tracker.prototype={end:function(){this._perfPtr.mark(this.endName)},endnmeas:function(name){return this.end(),this.meas()},meas:function(){return this.hasMeasured||(this._perfPtr.measure(this.measName,this.startName,this.endName),this.hasMeasured=!0),this._findmeas()},_findmeas:function(){for(var measures=this._perfPtr.getEntriesByType(MEAS_TYPE),i=0;i<measures.length;i++){var current=measures[i];if(current.name===this.measName)return current}}},ClearHelper.prototype={_set:function(perfPtr){this.perfPtr=perfPtr},mark:function(){this.perfPtr.clearMarks()},meas:function(){this.perfPtr.clearMeasures()}},LsHelper.prototype={_set:function(perfPtr){this.perfPtr=perfPtr},mark:function(){for(var marks=this.perfPtr.getEntriesByType(MARK_TYPE),result=[],i=0;i<marks.length;i++)result.push(marks[i].name);return result},meas:function(){for(var marks=this.perfPtr.getEntriesByType(MEAS_TYPE),result=[],i=0;i<marks.length;i++)result.push(marks[i].name);return result}},FindHelper.prototype={_set:function(perfPtr){this.perfPtr=perfPtr},mark:function(context){for(var marks=this.perfPtr.getEntriesByType(MARK_TYPE),result=[],i=0;i<marks.length;i++){var current=marks[i];-1!==current.name.indexOf(context)&&result.push(current)}return result},meas:function(context){for(var meas=this.perfPtr.getEntriesByType(MEAS_TYPE),result=[],i=0;i<meas.length;i++){var current=meas[i];-1!==current.name.indexOf(context)&&result.push(current)}return result}},PerfHelper.prototype={_set:function(perfPtr){this._perfPtr=perfPtr,this.clearHelper._set(perfPtr),this.lsHelper._set(perfPtr),this.findHelper._set(perfPtr)}},Object.defineProperties(PerfHelper.prototype,{clr:{get:function(){return this.clearHelper}},ls:{get:function(){return this.lsHelper}},find:{get:function(){return this.findHelper}}}),TrackerManager.prototype={setPerfPtr:function(object){object.mark&&object.measure&&object.getEntriesByType&&(this._perfPtr=object,this.perfHelper._set(object),object.onresourcetimingbufferfull&&(object.onresourcetimingbufferfull=function(){console.error("You cannot make more marks and measures try upping your buffersize")}))},start:function(name){this.enabled&&(this.trackers[name]=new Tracker(this.perfPtr,name))},end:function(name){this.enabled&&this.trackers[name]&&this.trackers[name].end()},endnmeas:function(name){if(this.enabled)return this.trackers[name]?this.trackers[name].endnmeas():void 0},meas:function(name){if(this.enabled)return this.trackers[name]?this.trackers[name].meas():void 0},specificMeas:function(name,startMarkName,endMarkName){return this.perfPtr.measure(name,startMarkName,endMarkName),this.perfPtr.getEntriesByType("measure").filter(function(m){return m.name===name})},withMeas:function(name,callback){try{this.start(name),callback()}finally{this.end(name)}},enable:function(enabled){this.enabled=enabled}},Object.defineProperties(TrackerManager.prototype,{BrowserFlags:{value:BrowserFlags,writable:!1},OsFlags:{value:OsFlags,writable:!1},perf:{get:function(){return this.perfHelper}},perfPtr:{get:function(){return this._perfPtr}},buffersize:{set:function(value){this._perfPtr.setResourceTimingBufferSize&&this._perfPtr.setResourceTimingBufferSize(value)}}}),meas=meas||new TrackerManager,"function"==typeof define&&define.amd&&define(function(){return meas}),window.meas=meas;